(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{13:function(t,e,s){"use strict";s.d(e,"a",(function(){return initGlobalScripts}));var r=s(11),a=s.n(r),i=s(10),n=s.n(i),o=s(4),c=s.n(o),l=s(3),u=s.n(l),d=function burgerToogler(){var t=this;c()(this,burgerToogler),u()(this,"toogle",(function(){for(var e=0,s=Object.entries(t.tooglers);e<s.length;e++){var r=n()(s[e],2),a=r[0],i=r[1];document.querySelector(a).classList.toggle(i)}})),this.tooglers={".menu__btn":"menu__btn_active",".header__popup":"header__popup_show",body:"lock__scroll"},document.querySelector(".menu__btn").onclick=this.toogle},_=function(){function searchToogler(t,e){var s=this;c()(this,searchToogler),u()(this,"goSearch",(function(){var t=document.querySelector(s.selectors.input).value;t.length>3&&(window.location.href="/catalog?query=".concat(t))})),u()(this,"show",(function(){if(s.isActive)s.goSearch();else for(var t=0,e=Object.entries(s.tooglers);t<e.length;t++){var r=n()(e[t],2),a=r[0],i=r[1];document.querySelector(a).classList.add(i)}})),u()(this,"close",(function(){for(var t=0,e=Object.entries(s.tooglers);t<e.length;t++){var r=n()(e[t],2),a=r[0],i=r[1];document.querySelector(a).classList.remove(i)}})),this.selectors=t,this.tooglers=e,document.querySelector(this.selectors.searchBtn).onclick=this.show,document.querySelector(this.selectors.cancelBtn).onclick=this.close,document.querySelector(this.selectors.input).addEventListener("keyup",(function(t){"Enter"===t.key&&s.goSearch()}))}return a()(searchToogler,[{key:"isActive",get:function get(){return document.querySelector(this.selectors.box).classList.contains("active")}}]),searchToogler}(),p=s(7),Layoutvue_type_template_id_663e9345_lang_pug_render=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"profile"},[s("a",{staticClass:"icon-profile js-login-btn"}),s("a",{staticClass:"icon-liked",attrs:{href:"/favorite"}},[s("div",{staticClass:"icon-liked_number",class:{gray:0==t.liked_cnt}},[t._v(t._s(t.liked_cnt))])]),s("a",{staticClass:"icon-basket",attrs:{href:"/cart"}},[s("div",{staticClass:"icon-basket_number",class:{gray:0==t.cart_cnt}},[t._v(t._s(t.cart_cnt))]),s("div",{staticClass:"js"})])])};Layoutvue_type_template_id_663e9345_lang_pug_render._withStripped=!0;var g=s(0),h=s.n(g),v=s(1),m=s.n(v),f=s(6),w={data:function data(){return{liked_cnt:0,cart_cnt:0}},methods:{update:function update(){var t=this;return m()(h.a.mark((function _callee(){var e;return h.a.wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,f.a.get("".concat(window.location.origin,"/api/cart/count")).json();case 2:(e=s.sent).count&&(t.cart_cnt=e.count);case 4:case"end":return s.stop()}}),_callee)})))()}},created:function created(){var t=this;return m()(h.a.mark((function _callee2(){return h.a.wrap((function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:t.update();case 1:case"end":return e.stop()}}),_callee2)})))()}},b=s(5),k=Object(b.a)(w,Layoutvue_type_template_id_663e9345_lang_pug_render,[],!1,null,null,null);k.options.__file="src/vue/profile-icons/Layout.vue";var y=k.exports,C=function _default(t){c()(this,_default),new p.a({el:t,render:function render(t){return t(y)}})},Layoutvue_type_template_id_190e3f8b_scoped_true_lang_pug_render=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"fade"}},[t.$root.hidden?t._e():s("div",{staticClass:"modal-login js-modal-login"},[s("div",{staticClass:"registration"},["login"==t.mode?s("div",{staticClass:"registration__wrapper"},[s("a",{staticClass:"js-close icon-menu-cancel",attrs:{id:"close_btn_avtorisation"},on:{click:t.close}}),s("div",{staticClass:"registration__title"},[t._v("Вход в личный кабинет")]),s("div",{staticClass:"registration__tip"},[s("span",{staticClass:"noaccount"},[t._v("Ещё нет аккаунта?")]),s("span",{staticClass:"noaccount__tip",on:{click:function(e){return t.switchMode("registration")}}},[t._v("Зарегистрироваться")])]),s("div",{staticClass:"registration__inner"},[s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"registration__input phone",attrs:{placeholder:"e-mail"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.isValidMail?"":"Некорректно введен email")+" ")]),s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"registration__input password",attrs:{type:"password",placeholder:"Пароль"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.password.length>0&&t.password.length<6?"Пароль слишком короткий":"")+" ")])]),s("div",{staticClass:"registration__tip"},[s("span",{staticClass:"restore"},[t._v("Забыли пароль?")]),s("span",{staticClass:"restore__tip",on:{click:function(e){return t.switchMode("request")}}},[t._v("Восстановление")])]),s("div",{staticClass:"registration__button_wrapper"},[s("button",{staticClass:"registration__btn button",attrs:{disabled:!t.isValidMail||t.password.length<6},on:{click:t.login}},[t._v("ВОЙТИ")])])]):"restore"==t.mode?s("div",{staticClass:"registration__wrapper"},[s("a",{staticClass:"js-close",attrs:{id:"close_btn_avtorisation"},on:{click:t.close}},[s("img",{staticClass:"registration__close",attrs:{src:"/assets/img/icons/close.svg"}})]),s("div",{staticClass:"registration__title long"},[t._v("Введите новый пароль")]),s("div",{staticClass:"registration__inner"},[s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"registration__input password",attrs:{type:"password",placeholder:"Пароль"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},t.checkValid]}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.passErrorText)+" ")]),s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.verifiedPassword,expression:"verifiedPassword"}],staticClass:"registration__input password",attrs:{type:"password",placeholder:"Подтверждение пароля"},domProps:{value:t.verifiedPassword},on:{input:function(e){e.target.composing||(t.verifiedPassword=e.target.value)}}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.equal||0==t.password.length||0==t.verifiedPassword.length?"":"Пароли не совпадают")+" ")])]),s("div",{staticClass:"registration__button_wrapper"},[s("button",{staticClass:"registration__btn button save",attrs:{disabled:!t.isValidPass||!t.agree||!t.equal},on:{click:t.changePassword}},[t._v("СОХРАНИТЬ")])])]):"registration"==t.mode?s("div",{staticClass:"registration__wrapper"},[s("a",{staticClass:"js-close",attrs:{id:"close_btn_avtorisation"},on:{click:t.close}},[s("img",{staticClass:"registration__close",attrs:{src:"/assets/img/icons/close.svg"}})]),s("div",{staticClass:"registration__title long"},[t._v("Регистрация")]),s("div",{staticClass:"registration__inner"},[s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"registration__input email",attrs:{placeholder:"e-mail"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.isValidMail?"":"Неверно введен email")+" ")]),s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"registration__input password",attrs:{type:"password",placeholder:"Пароль"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},t.checkValid]}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.passErrorText)+" ")]),s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.verifiedPassword,expression:"verifiedPassword"}],staticClass:"registration__input password",attrs:{type:"password",placeholder:"Подтверждение пароля"},domProps:{value:t.verifiedPassword},on:{input:function(e){e.target.composing||(t.verifiedPassword=e.target.value)}}})]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.equal||0==t.password.length||0==t.verifiedPassword.length?"":"Пароли не совпадают")+" ")]),s("div",{staticClass:"registration__agreement"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.agree,expression:"agree"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.agree)?t._i(t.agree,null)>-1:t.agree},on:{change:function(e){var s=t.agree,r=e.target,a=!!r.checked;if(Array.isArray(s)){var i=t._i(s,null);r.checked?i<0&&(t.agree=s.concat([null])):i>-1&&(t.agree=s.slice(0,i).concat(s.slice(i+1)))}else t.agree=a}}}),s("div",{staticClass:"registration__agreement-text"},[t._v("Cогласие на обработку персональных данных "),s("span",[t._v("Политика конфиденциональности")])])]),s("div",{staticClass:"registration__tip"},[s("span",{staticClass:"noaccount__tip",on:{click:function(e){return t.switchMode("login")}}},[t._v("К авторизации")])]),s("div",{staticClass:"registration__button_wrapper"},[s("button",{staticClass:"registration__btn button",attrs:{disabled:!(t.isValidMail&&t.isValidPass&&t.agree&&t.equal)},on:{click:t.register}},[t._v("ЗАРЕГИСТРИРОВАТЬСЯ")])])])]):"info"==t.mode?s("div",{staticClass:"registration__wrapper"},[s("a",{staticClass:"js-close",attrs:{id:"close_btn_avtorisation"},on:{click:t.close}},[s("img",{staticClass:"registration__close",attrs:{src:"/assets/img/icons/close.svg"}})]),s("div",{staticClass:"registration__title long"},[t._v("Подтвердите E-mail")]),s("div",{staticClass:"registration__inner"},[s("div",{staticClass:"registration__label"},[t._v("На Вашу почту выслан код с подтверждением")])])]):"success"==t.mode?s("div",{staticClass:"registration__wrapper"},[s("a",{staticClass:"js-close",attrs:{id:"close_btn_avtorisation"},on:{click:t.close}},[s("svg",{staticClass:"registration__close"},[s("use",{attrs:{href:"/assets/icons/icons.svg#close"}})])]),s("div",{staticClass:"registration__title long"},[t._v("Подтверждение E-mail")]),s("div",{staticClass:"registration__inner"},[s("div",{staticClass:"registration__label"},[t._v("Учетная запись успешно активирована")])]),s("div",{staticClass:"registration__button_wrapper"},[s("button",{staticClass:"registration__btn button",on:{click:function(e){return t.switchMode("login")}}},[t._v("ВОЙТИ")])])]):"request"==t.mode?s("div",{staticClass:"registration__wrapper"},[s("a",{staticClass:"js-close",attrs:{id:"close_btn_avtorisation"},on:{click:t.close}},[s("img",{staticClass:"registration__close",attrs:{src:"/assets/img/icons/close.svg"}})]),s("div",{staticClass:"registration__title long"},[t._v("Введите E-mail")]),s("div",{staticClass:"registration__inner"},[s("div",{staticClass:"registration__item"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"registration__input email",attrs:{placeholder:"e-mail"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})])]),s("div",{staticClass:"registration__error"},[t._v(t._s(t.isValidMail?"":"Неверно введен email")+" ")]),s("div",{staticClass:"registration__tip"},[s("span",{staticClass:"noaccount__tip",on:{click:function(e){return t.switchMode("login")}}},[t._v("К авторизации")])]),s("div",{staticClass:"registration__button_wrapper"},[s("button",{staticClass:"registration__btn button",attrs:{disabled:!t.isValidMail||0==t.email.length},on:{click:t.requestRestore}},[t._v("ВОССТАНОВЛЕНИЕ")])])]):t._e()])])])};Layoutvue_type_template_id_190e3f8b_scoped_true_lang_pug_render._withStripped=!0;s(9);var x=s(2),j={components:{},props:{},data:function data(){return{id:null,restoreToken:null,email:"",password:"",verifiedPassword:"",passErrorText:"",mode:"login",agree:!1,isError:!1,modes:{login:"Вход",registration:"Регистрация",loading:"Загрузка",info:"Подтверждение email",success:"Подтверждение email",request:"Подтверждение email",restore:"Восстановление пароля"}}},computed:{isValidMail:function isValidMail(){return 0==this.email.length||this.email.match(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/g)},isValidPass:function isValidPass(){return this.password.match(/^(?=.*\d)(?=.*[a-zA-Z])(?!.*\s)(?=^.{6,}$).*$/)},equal:function equal(){return this.password===this.verifiedPassword&&0!=this.password.length&&0!=this.verifiedPassword.length},caption:function caption(){return this.modes[this.mode]}},methods:{switchMode:function switchMode(t){this.mode=t,this.password="",this.verifiedPassword="",this.email=""},checkValid:function checkValid(){0==this.password.length?this.passErrorText="":this.password.length>0&&this.password.length<6?this.passErrorText="Пароль слишком короткий":this.password.match(/^(?=.*\d)(?=.*[a-zA-Z])(?!.*\s)(?=^.{6,}$).*$/)?this.passErrorText="":this.passErrorText="Пароль должен содержать буквы и цифры"},close:function close(){"login"===this.mode?window.location.href="/":"info"==this.mode||"success"==this.mode||"request"==this.mode?this.switchMode("login"):(this.mode="restore")&&(window.location.href="/lk"),this.$root.toggle()},closeSuccessfully:function closeSuccessfully(){this.$emit("toggle"),this.email="",this.password="",this.verifiedPassword="",this.switchMode("login")},register:function register(){var t=this;return m()(h.a.mark((function _callee(){var e,s;return h.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("api/auth/basic/register",{method:"POST",body:JSON.stringify({email:t.email,password:t.password})});case 3:if(!(e=r.sent).ok){r.next=8;break}t.switchMode("info"),r.next=12;break;case 8:return r.next=10,e.json();case 10:throw result=r.sent,result.errors[0].message;case 12:r.next=18;break;case 14:r.prev=14,r.t0=r.catch(0),s="string"==typeof r.t0?r.t0:"Неизвестная ошибка",Object(x.a)("error",s);case 18:case"end":return r.stop()}}),_callee,null,[[0,14]])})))()},login:function login(){var t=this;return m()(h.a.mark((function _callee2(){var e,s,r;return h.a.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return e=null,a.prev=1,a.next=4,fetch("api/auth/basic/login",{method:"POST",body:JSON.stringify({email:t.email,password:t.password})});case 4:if(!(s=a.sent).ok){a.next=14;break}return a.next=8,s.json();case 8:e=a.sent,localStorage.setItem("jwt",JSON.stringify(e)),t.closeSuccessfully(),document.location.href="/lk",a.next=18;break;case 14:return a.next=16,s.json();case 16:throw(e=a.sent).errors[0].message;case 18:a.next=24;break;case 20:a.prev=20,a.t0=a.catch(1),r="string"==typeof a.t0?a.t0:"Ошибка авторизации",Object(x.a)("error",r);case 24:case"end":return a.stop()}}),_callee2,null,[[1,20]])})))()},changePassword:function changePassword(){var t=this;return m()(h.a.mark((function _callee3(){var e,s;return h.a.wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("/api/auth/basic/restore",{method:"POST",body:JSON.stringify({token:t.restoreToken,id:t.id,password:t.password})});case 3:if(!(e=r.sent).ok){r.next=9;break}t.switchMode("login"),Object(x.a)("success","Пароль успешно изменен"),r.next=13;break;case 9:return r.next=11,e.json();case 11:throw result=r.sent,result.errors[0].message;case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(0),s="string"==typeof r.t0?r.t0:"Неизвестная ошибка",Object(x.a)("error",s);case 19:case"end":return r.stop()}}),_callee3,null,[[0,15]])})))()},requestRestore:function requestRestore(){var t=this;return m()(h.a.mark((function _callee4(){var e,s;return h.a.wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch("/api/auth/basic/restore/request",{method:"POST",body:JSON.stringify({email:t.email})});case 3:if(!(e=r.sent).ok){r.next=8;break}t.switchMode("info"),r.next=12;break;case 8:return r.next=10,e.json();case 10:throw result=r.sent,result.errors[0].message;case 12:r.next=18;break;case 14:r.prev=14,r.t0=r.catch(0),s="string"==typeof r.t0?r.t0:"Неизвестная ошибка",Object(x.a)("error",s);case 18:case"end":return r.stop()}}),_callee4,null,[[0,14]])})))()}},created:function created(){var t=this;return m()(h.a.mark((function _callee5(){var e,s,r,a,i,n,o,c;return h.a.wrap((function _callee5$(l){for(;;)switch(l.prev=l.next){case 0:if(e=new URL(window.location.href).searchParams,s=e.get("mode"),r=e.get("token"),a=e.get("id"),null,r&&a&&s){l.next=9;break}return l.abrupt("return");case 9:if(!localStorage.getItem("jwt")){l.next=12;break}return Object(x.a)("error","Ошибка"),l.abrupt("return");case 12:if(t.mode="loading","confirm"!=s){l.next=34;break}return l.prev=14,l.next=17,fetch("/api/auth/basic/confirm",{method:"POST",body:JSON.stringify({token:r,id:a})});case 17:if(!(i=l.sent).ok){l.next=22;break}t.switchMode("success"),l.next=26;break;case 22:return l.next=24,i.json();case 24:throw l.sent.errors[0].message;case 26:l.next=32;break;case 28:l.prev=28,l.t0=l.catch(14),n="string"==typeof l.t0?l.t0:"Неизвестная ошибка",Object(x.a)("error",n);case 32:l.next=55;break;case 34:if("restore"!=s){l.next=55;break}return l.prev=35,l.next=38,fetch("/api/auth/basic/valid",{method:"POST",body:JSON.stringify({token:r,id:a})});case 38:if(!(o=l.sent).ok){l.next=45;break}t.switchMode("restore"),t.restoreToken=r,t.id=a,l.next=49;break;case 45:return l.next=47,o.json();case 47:throw l.sent.errors[0].message;case 49:l.next=55;break;case 51:l.prev=51,l.t1=l.catch(35),c="string"==typeof l.t1?l.t1:"Неизвестная ошибка",Object(x.a)("error",c);case 55:case"end":return l.stop()}}),_callee5,null,[[14,28],[35,51]])})))()}},S=Object(b.a)(j,Layoutvue_type_template_id_190e3f8b_scoped_true_lang_pug_render,[],!1,null,"190e3f8b",null);S.options.__file="src/vue/ModalLogin/Layout.vue";var P=S.exports,O=function(){function LoginModal(){c()(this,LoginModal);var t=document.getElementById("modal-login"),e=t.dataset.agreePageLink;this.vmLoginModal=new p.a({name:"LoginModal",data:{hidden:!0},el:t,methods:{toggle:function toggle(){this.hidden=!this.hidden,document.body.classList.toggle("no-scroll")}},render:function render(t){return t(P,{props:{agreePageLink:e}})}}),this.token=JSON.parse(localStorage.getItem("jwt")),this.loginBtn=document.querySelector(".js-login-btn"),this.init()}return a()(LoginModal,[{key:"init",value:function init(){var t=this;this.loginBtn&&this.loginBtn.addEventListener("click",(function(){t.handleLoginClick()}))}},{key:"handleLoginClick",value:function handleLoginClick(){if(this.token&&"accessToken"in this.token){var t=document.createElement("a");t.href="/lk",t.click()}else this.vmLoginModal.toggle()}},{key:"toggle",value:function toggle(){this.vmLoginModal.toggle()}}]),LoginModal}();function initGlobalScripts(){window.profile=new C("#profile"),new d,new _({box:".search__box",searchBtn:".search__btn",cancelBtn:".cancel__btn",input:".js-query"},{".search__box":"active",".input__search":"input__active",".search__btn":"search__btn_active",".cancel__btn":"cancel__btn_active",".phone":"phone__hidden",".profile":"profile__hidden",".nav":"nav__hidden"}),new _({box:".search__box_mobile",searchBtn:".search__btn_mobile",cancelBtn:".cancel__btn_mobile",input:".js-query-m"},{".search__box_mobile":"active",".input__search_mobile":"input__active",".search__btn_mobile":"search__btn_active",".cancel__btn_mobile":"cancel__btn_active",".block__first":"block__first_hidden",".mobile__block":"mobile__block_active",".block__second":"block__second_active"}),window.modalLogin=new O;document.querySelector(".add__to__cart"),document.querySelector(".popup__card__item"),document.querySelector(".close__popup")}},2:function(t,e,s){"use strict";s.d(e,"a",(function(){return noty_noty}));var r=s(3),a=s.n(r),i=s(16),n=s.n(i),o=s(20),c=s.n(o);s(24);function ownKeys(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(s),!0).forEach((function(e){a()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var l={theme:"custom",layout:"topRight",type:"information",text:"",timeout:5e3,progressBar:!0,closeWith:["click","button"]},u={};function noty_noty(){var t=["alert","success","warning","error","information"],e=["top","topLeft","topCenter","topRight","center","centerLeft","centerRight","bottom","bottomLeft","bottomCenter","bottomRight"];Object.values(arguments).forEach((function(s){switch(n()(s)){case"object":u=s;break;case"number":l.timeout=s;break;case"string":t.some((function(t){return t===s}))?l.type=s:"warn"===s?l.type="warning":"info"===s?l.type="information":e.some((function(t){return t===s}))?l.layout=s:l.text=s;break;case"boolean":l.progressBar=s}}));var s=_objectSpread(_objectSpread({},l),u);return new c.a(s).show()}},9:function(t,e,s){"use strict";var r=s(0),a=s.n(r),i=s(1),n=s.n(i),o=s(4),c=s.n(o),l=s(17),u=s.n(l),d=s(18),_=s.n(d),p=s(14),g=s.n(p),h=s(19);function _createSuper(t){var e=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var s,r=g()(t);if(e){var a=g()(this).constructor;s=Reflect.construct(r,arguments,a)}else s=r.apply(this,arguments);return _()(this,s)}}var v=function(t){u()(AuthError,t);var e=_createSuper(AuthError);function AuthError(t){var s;return c()(this,AuthError),(s=e.call(this,t)).name="AuthError",s}return AuthError}(s.n(h)()(Error));e.a=function(){var t=n()(a.a.mark((function _callee(t){var e,s,r,i,n,o=arguments;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(e=o.length>1&&void 0!==o[1]?o[1]:{},s=o.length>2&&void 0!==o[2]?o[2]:"jwt",r=window.localStorage.getItem(s)){a.next=5;break}throw new v("Вы не авторизованы");case 5:return i=JSON.parse(r),console.log(i),(n=new URL(t)).searchParams.set(s,i.accessToken),a.abrupt("return",fetch(n,e).then((function(t){if(409===t.status){var r=new URL(i._links.refresher.href);return r.searchParams.set("token",i.refreshToken),fetch(r,{method:"POST"}).then((function(t){return 200===t.status?t.json().then((function(t){return window.localStorage.setItem(s,JSON.stringify(t)),n.searchParams.set(s,t.accessToken),fetch(n,e)})):t}))}return t})));case 10:case"end":return a.stop()}}),_callee)})));return function(e){return t.apply(this,arguments)}}()}}]);