
(function(global,factory){if(typeof define==="function"&&define.amd){define(['exports'],factory);}else if(typeof exports!=="undefined"){factory(exports);}else{var mod={exports:{}};factory(mod.exports);global.eventEmitter=mod.exports;}})(this,function(exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var EventEmitter=function(){function EventEmitter(){_classCallCheck(this,EventEmitter);this._queue=[];}
_createClass(EventEmitter,[{key:'emit',value:function emit(){for(var _len=arguments.length,argv=Array(_len),_key=0;_key<_len;_key++){argv[_key]=arguments[_key];}
this._queue.forEach(function(handler){handler.apply(undefined,argv);});}},{key:'push',value:function push(handler){this._queue.push(handler);return this;}},{key:'clear',value:function clear(){this._queue=[];}}]);return EventEmitter;}();exports.default=EventEmitter;});


(function(global,factory){if(typeof define==="function"&&define.amd){define(['exports','event-emitter.js'],factory);}else if(typeof exports!=="undefined"){factory(exports,require('event-emitter.js'));}else{var mod={exports:{}};factory(mod.exports,global.eventEmitter);global.dreciver=mod.exports;}})(this,function(exports,_eventEmitter){'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _eventEmitter2=_interopRequireDefault(_eventEmitter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var DReciver=function(){function DReciver(channelName,node){_classCallCheck(this,DReciver);this._target=node;this._events={'reciver-over':new _eventEmitter2.default(),'reciver-enter':new _eventEmitter2.default(),'reciver-exit':new _eventEmitter2.default(),'reciver-drop':new _eventEmitter2.default(),'reciver-activate':new _eventEmitter2.default(),'reciver-deactivate':new _eventEmitter2.default()};this._handlers={'dragover':this._setDragOver.bind(this),'dragexit':this._setDragExit.bind(this),'dragenter':this._setDragEnter.bind(this),'drop':this._setDragDrop.bind(this)};this._cssClass={'over':'reciver-over','enter':'reciver-enter','drop':'reciver-drop','error':'reciver-error','access':'reciver-access'};this.setHandeler();}
_createClass(DReciver,[{key:'setName',value:function setName(){this._channelName;}},{key:'getName',value:function getName(){return this._channelName;}},{key:'setHandeler',value:function setHandeler(){var target=this._target;var handlers=this._handlers;for(var handlerName in handlers){target.addEventListener(handlerName,handlers[handlerName],false);}}},{key:'getTarget',value:function getTarget(){return this._target;}},{key:'setActive',value:function setActive(){var event=this._events['reciver-activate'];var cssList=this._cssClass;this._target.classList.add(cssList.access);event.emit(this._target);}},{key:'_canBeDroped',value:function _canBeDroped(dataTransfer){var current=this._target;var cssList=this._cssClass;if(!current.classList.contains(cssList.access)){dataTransfer.effectAllowed='none';return false;}else{dataTransfer.effectAllowed='move';return true;}}},{key:'_setDragOver',value:function _setDragOver(e){e=e?e:window.event;if(!this._canBeDroped(e.dataTransfer))return;this._target.classList.add(this._cssClass['over']);var event=this._events['reciver-over'];event.emit(e.target);e.preventDefault();}},{key:'_setDragExit',value:function _setDragExit(e){e=e?e:window.event;if(!this._canBeDroped(e.dataTransfer))return;this._target.classList.remove(this._cssClass['over']);this._target.classList.remove(this._cssClass['enter']);var event=this._events['reciver-exit'];event.emit(e.target);e.preventDefault();}},{key:'_setDragEnter',value:function _setDragEnter(e){e=e?e:window.event;if(!this._canBeDroped(e.dataTransfer))return;this._target.classList.add(this._cssClass['enter']);var event=this._events['reciver-enter'];event.emit(e.target);e.preventDefault();}},{key:'_setDragDrop',value:function _setDragDrop(e){e=e?e:window.event;var event=this._events['reciver-drop'];var current=this._target;var data=JSON.parse(e.dataTransfer.getData('text'));event.emit(data,current);e.preventDefault();}},{key:'cleanState',value:function cleanState(){var event=this._events['reciver-deactivate'];var current=this._target;for(var key in this._cssClass){current.classList.remove(this._cssClass[key]);}event.emit(this._target);}},{key:'on',value:function on(eventName,handler){var events=this._events;if(events[eventName]){var emitter=events[eventName];emitter.push(handler);}}}]);return DReciver;}();exports.default=DReciver;});


(function(global,factory){if(typeof define==="function"&&define.amd){define(['exports','dsender.js','dreciver.js'],factory);}else if(typeof exports!=="undefined"){factory(exports,require('dsender.js'),require('dreciver.js'));}else{var mod={exports:{}};factory(mod.exports,global.dsender,global.dreciver);global.dchannel=mod.exports;}})(this,function(exports,_dsender,_dreciver){'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _dsender2=_interopRequireDefault(_dsender);var _dreciver2=_interopRequireDefault(_dreciver);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var DChannel=function(){function DChannel(){_classCallCheck(this,DChannel);this._pool={};this.init();}
_createClass(DChannel,[{key:'init',value:function init(){var _this=this;var reciverNodeList=document.querySelectorAll('['+'data-channel-name'+']');reciverNodeList.forEach(function(node){_this.addChannel(node.getAttribute('data-channel-name'),node);});}},{key:'addChannel',value:function addChannel(channelName,reciverTarget){var channel=this.getChannel(channelName);if(channel)channel.push(new _dreciver2.default(channelName,reciverTarget));else this._pool[channelName]=[new _dreciver2.default(channelName,reciverTarget)];}},{key:'getChannel',value:function getChannel(channelName){if(this.channelExsist(channelName))return this._pool[channelName];else return false;}},{key:'channelExsist',value:function channelExsist(channelName){return this._pool.hasOwnProperty(channelName);}},{key:'activateChannel',value:function activateChannel(channels){var _this2=this;channels.map(function(channelName){var reciverList=_this2.getChannel(channelName);if(reciverList)reciverList.map(function(reciver){reciver.setActive();});});}},{key:'dropEnd',value:function dropEnd(channels){var _this3=this;channels.map(function(channelName){var reciverList=_this3.getChannel(channelName);if(reciverList)reciverList.map(function(reciver){reciver.cleanState();});});}},{key:'setHandler',value:function setHandler(channelList,handlerName,callback){var _this4=this;channelList.map(function(channelName){var reciverList=_this4.getChannel(channelName);if(reciverList)reciverList.map(function(reciver){reciver.on(handlerName,callback);});});return this;}}]);return DChannel;}();window.DChannel=new DChannel();exports.default=window.DChannel;});


(function(global,factory){if(typeof define==="function"&&define.amd){define(['event-emitter.js','dchannel.js'],factory);}else if(typeof exports!=="undefined"){factory(require('event-emitter.js'),require('dchannel.js'));}else{var mod={exports:{}};factory(global.eventEmitter,global.dchannel);global.dsender=mod.exports;}})(this,function(_eventEmitter,_dchannel){'use strict';var _eventEmitter2=_interopRequireDefault(_eventEmitter);var _dchannel2=_interopRequireDefault(_dchannel);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var DSender=function(){function DSender(node){_classCallCheck(this,DSender);this._node=node;this._channels=[];this._events={'dstart':new _eventEmitter2.default(),'dend':new _eventEmitter2.default()};this._handlers={'dragstart':this.setDragStart.bind(this),'dragend':this.setDragEnd.bind(this)};this._node.setAttribute('draggable',true);this._node.addEventListener('dragstart',this._handlers.dragstart,false);this._node.addEventListener('dragend',this._handlers.dragend,false);this.init();}
_createClass(DSender,[{key:'init',value:function init(){var _this=this;var node=this._node;if(!node.hasAttribute('data-subscribe'))return;var subscribeList=node.getAttribute('data-subscribe').split(',').map(function(channelName){if(_dchannel2.default.channelExsist(channelName))_this.addChannel(channelName);});}},{key:'addChannel',value:function addChannel(channelName){if(!this._channels.includes(channelName))this._channels.push(channelName);}},{key:'setDragStart',value:function setDragStart(e){e=e?e:window.event;var event=this._events['dstart'];var message=void 0;if(this._node.hasAttribute('data-message'))message=JSON.parse(this._node.getAttribute('data-message'));else message={};e.dataTransfer.effectAllowed='move';event.emit(this._node);var data={};data['message']=message;data['channels']=this._channels;_dchannel2.default.activateChannel(this._channels);e.dataTransfer.setData('text/plain',JSON.stringify(data));}},{key:'setDragEnd',value:function setDragEnd(e){var event=this._events['dend'];_dchannel2.default.dropEnd(this._channels);event.emit();}},{key:'on',value:function on(eventName,handler){var events=this._events;if(events[eventName]){var emitter=events[eventName];emitter.push(handler);}}}]);return DSender;}();window.DSender=DSender;});


//# sourceMappingURL=maps/dndlib.min.js.map
